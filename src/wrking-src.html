<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptCraft Pro - Advanced AI Image Prompt Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class', // Using 'class' strategy
            theme: {
                extend: {
                    colors: {
                        dark: {
                            50: '#F5F5F5',
                            100: '#E0E0E0',
                            200: '#B0B0B0',
                            300: '#808080',
                            400: '#505050',
                            500: '#303030',
                            600: '#252525',
                            700: '#202020',
                            800: '#1A1A1A',
                            900: '#121212',
                        },
                        purple: {
                            900: '#4B0082', // Indigo
                            800: '#5E1A9E',
                            700: '#6B46C1', // Main Purple
                            600: '#7C3AED',
                            500: '#8B5CF6', // Lighter Purple
                        }
                    },
                    animation: {
                        'spin-slow': 'spin 3s linear infinite',
                        'pulse-fast': 'pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'bounce-short': 'bounce 1s ease-in-out 3'
                    },
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Ensure dark mode is default if no preference is set */
        :root {
            color-scheme: dark;
        }
        html.dark body {
             background-color: #121212; /* dark-900 */
             color: #E0E0E0; /* dark-100 */
        }
        html:not(.dark) body {
            background-color: #f3f4f6; /* gray-100 */
            color: #1f2937; /* gray-800 */
        }

        .gradient-bg {
            background: linear-gradient(135deg, #6B46C1 0%, #4B0082 100%);
        }
        .prompt-card {
            transition: all 0.3s ease;
            min-height: 200px;
            border: 1px solid;
        }
        html.dark .prompt-card {
            background-color: #252525; /* dark-600 */
            border-color: #505050; /* dark-400 */
        }
        html:not(.dark) .prompt-card {
            background-color: white;
            border-color: #e5e7eb; /* gray-200 */
        }
        .prompt-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
        }
        html.dark .prompt-card:hover {
             border-color: #6B46C1; /* purple-700 */
        }
        html:not(.dark) .prompt-card:hover {
            border-color: #8B5CF6; /* purple-500 */
        }

        /* Input styling */
        textarea, input[type="text"], input[type="search"], select {
            border-width: 1px;
            border-radius: 0.5rem; /* rounded-lg */
            padding: 0.5rem 1rem; /* px-4 py-2 */
        }
        html.dark textarea, html.dark input[type="text"], html.dark input[type="search"], html.dark select {
            background-color: #252525; /* dark-600 */
            color: #E0E0E0; /* dark-100 */
            border-color: #505050; /* dark-400 */
        }
        html:not(.dark) textarea, html:not(.dark) input[type="text"], html:not(.dark) input[type="search"], html:not(.dark) select {
            background-color: white;
            color: #1f2937; /* gray-800 */
            border-color: #d1d5db; /* gray-300 */
        }
        html.dark textarea::placeholder, html.dark input::placeholder { color: #808080; /* dark-300 */ }
        html:not(.dark) textarea::placeholder, html:not(.dark) input::placeholder { color: #9ca3af; /* gray-400 */ }

        textarea:focus, input[type="text"]:focus, input[type="search"]:focus, select:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--tw-ring-color); /* ring-2 */
        }
        html.dark textarea:focus, html.dark input[type="text"]:focus, html.dark input[type="search"]:focus, html.dark select:focus {
            --tw-ring-color: #7C3AED; /* purple-600 */
            border-color: #7C3AED;
        }
        html:not(.dark) textarea:focus, html:not(.dark) input[type="text"]:focus, html:not(.dark) input[type="search"]:focus, html:not(.dark) select:focus {
            --tw-ring-color: #8B5CF6; /* purple-500 */
            border-color: #8B5CF6;
        }
        
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        ::selection { background: #6B46C1; color: white; }
        ::-webkit-scrollbar { width: 8px; }
        html.dark ::-webkit-scrollbar-track { background: #252525; } /* dark-600 */
        html:not(.dark) ::-webkit-scrollbar-track { background: #e5e7eb; } /* gray-200 */
        ::-webkit-scrollbar-thumb { background: #6B46C1; border-radius: 4px; }
        
        /* Toggle Switch */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #6B46C1; /* purple-700 */
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #6B46C1; /* purple-700 */
        }
        html.dark .toggle-label { background-color: #505050; /* dark-400 */ }
        html:not(.dark) .toggle-label { background-color: #d1d5db; /* gray-300 */ }
        html.dark .toggle-checkbox { background-color: #E0E0E0; /* dark-100 */ } /* Switch itself */
        html:not(.dark) .toggle-checkbox { background-color: white; }

        /* Button styling */
        .btn {
            padding: 0.75rem 1.5rem; /* px-6 py-3 */
            border-radius: 0.5rem; /* rounded-lg */
            font-weight: 500; /* font-medium */
            transition: all 0.2s ease-in-out;
            display: inline-flex;
            align-items: center;
        }
        .btn-primary {
            background: linear-gradient(135deg, #7C3AED 0%, #5E1A9E 100%); /* purple-600 to purple-800 */
            color: white;
        }
        .btn-primary:hover { opacity: 0.9; box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4); }
        
        .btn-secondary {
            color: #E0E0E0; /* dark-100 */
            border: 1px solid;
        }
        html.dark .btn-secondary {
            background-color: #303030; /* dark-500 */
            border-color: #505050; /* dark-400 */
        }
        html:not(.dark) .btn-secondary {
            background-color: #e5e7eb; /* gray-200 */
            color: #374151; /* gray-700 */
            border-color: #d1d5db; /* gray-300 */
        }
        html.dark .btn-secondary:hover {
            background-color: #505050; /* dark-400 */
            border-color: #7C3AED; /* purple-600 */
        }
        html:not(.dark) .btn-secondary:hover {
            background-color: #d1d5db; /* gray-300 */
            border-color: #8B5CF6; /* purple-500 */
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem; /* mb-4 */
        }
        .section-header h2 {
            margin-bottom: 0; /* Reset default margin if any */
        }
        .randomize-section-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #8B5CF6; /* purple-500 */
            font-size: 1.25rem; /* text-xl */
            transition: color 0.2s, transform 0.2s;
        }
        .randomize-section-btn:hover {
            color: #6B46C1; /* purple-700 */
            transform: rotate(15deg);
        }
    </style>
</head>
<body class="min-h-screen"> <div class="gradient-bg text-white py-12 px-4 sm:px-6 lg:px-8">
        <div class="max-w-4xl mx-auto text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">PromptCraft Pro</h1>
            <p class="text-xl md:text-2xl opacity-90">Advanced AI Image & Video Prompt Generator</p>
            <p class="mt-2 opacity-80">Create stunning prompts for Midjourney, DALLÂ·E, Stable Diffusion, Sora and more</p>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="bg-opacity-50 backdrop-blur-md rounded-xl shadow-lg p-6 mb-8 border"
             id="settingsContainer"> <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <div class="lg:col-span-1">
                    <div class="section-header">
                        <h2 class="text-2xl font-semibold text-purple-400 flex items-center">
                            <i class="fas fa-cube mr-2"></i> Core Elements
                        </h2>
                        <button class="randomize-section-btn" id="randomizeCoreBtn" title="Randomize Core Elements">
                            <i class="fas fa-dice-three"></i>
                        </button>
                    </div>
                    
                    <div class="mb-4">
                        <label for="subject" class="block text-sm font-medium mb-1">Main Subject *</label>
                        <input type="text" id="subject" placeholder="e.g., cyberpunk detective, mystical forest">
                    </div>
                    <div class="mb-4">
                        <label for="subject-desc" class="block text-sm font-medium mb-1">Subject Description</label>
                        <textarea id="subject-desc" placeholder="Physical appearance, clothing, expression, etc." class="h-24"></textarea>
                    </div>
                    <div class="mb-4">
                        <label for="environment" class="block text-sm font-medium mb-1">Environment/Setting</label>
                        <input type="text" id="environment" placeholder="e.g., neon-lit alley, enchanted castle">
                    </div>
                    <div class="mb-4">
                        <label for="action" class="block text-sm font-medium mb-1">Key Action</label>
                        <input type="text" id="action" placeholder="e.g., casting a spell, running from danger">
                    </div>
                </div>
                
                <div class="lg:col-span-1">
                    <div class="section-header">
                        <h2 class="text-2xl font-semibold text-purple-400 flex items-center">
                            <i class="fas fa-palette mr-2"></i> Style & Composition
                        </h2>
                        <button class="randomize-section-btn" id="randomizeStyleBtn" title="Randomize Style & Composition">
                            <i class="fas fa-dice-three"></i>
                        </button>
                    </div>
                    <div class="mb-4">
                        <label for="style" class="block text-sm font-medium mb-1">Art Style (Dropdown)</label>
                        <select id="style">
                            <option value="">Any style</option>
                            <optgroup label="Traditional Art">
                                <option value="oil painting">Oil painting</option>
                                <option value="watercolor">Watercolor</option>
                                <option value="ink wash">Ink wash</option>
                                <option value="charcoal sketch">Charcoal sketch</option>
                                <option value="impressionist">Impressionist</option>
                            </optgroup>
                            <optgroup label="Digital & Contemporary">
                                <option value="hyperrealistic">Hyperrealistic</option>
                                <option value="concept art">Concept art</option>
                                <option value="digital painting">Digital painting</option>
                                <option value="low poly">Low poly</option>
                                <option value="vector art">Vector art</option>
                            </optgroup>
                            <optgroup label="Genre Styles">
                                <option value="cyberpunk">Cyberpunk</option>
                                <option value="steampunk">Steampunk</option>
                                <option value="dieselpunk">Dieselpunk</option>
                                <option value="biopunk">Biopunk</option>
                                <option value="fantasy">Fantasy</option>
                            </optgroup>
                            <optgroup label="Cultural Styles">
                                <option value="ukiyo-e">Ukiyo-e</option>
                                <option value="art nouveau">Art Nouveau</option>
                                <option value="bauhaus">Bauhaus</option>
                                <option value="surrealism">Surrealism</option>
                                <option value="abstract expressionism">Abstract Expressionism</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="customStyle" class="block text-sm font-medium mb-1">Custom Art Style (Overrides)</label>
                        <input type="text" id="customStyle" placeholder="e.g., vintage sci-fi poster, gritty comic book">
                    </div>
                    <div class="mb-4">
                        <label for="lighting" class="block text-sm font-medium mb-1">Lighting</label>
                        <select id="lighting">
                            <option value="">Any lighting</option>
                            <option value="dramatic chiaroscuro">Dramatic chiaroscuro</option>
                            <option value="soft diffused">Soft diffused</option>
                            <option value="neon glow">Neon glow</option>
                            <option value="golden hour">Golden hour</option>
                            <option value="moonlit">Moonlit</option>
                            <option value="bioluminescent">Bioluminescent</option>
                            <option value="volumetric god rays">Volumetric god rays</option>
                            <option value="film noir">Film noir</option>
                            <option value="studio lighting">Studio lighting</option>
                            <option value="candlelit">Candlelit</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="composition" class="block text-sm font-medium mb-1">Composition</label>
                        <select id="composition">
                            <option value="">Any composition</option>
                            <option value="extreme close-up">Extreme close-up</option>
                            <option value="medium shot">Medium shot</option>
                            <option value="wide shot">Wide shot</option>
                            <option value="aerial view">Aerial view</option>
                            <option value="macro">Macro</option>
                            <option value="symmetrical">Symmetrical</option>
                            <option value="dynamic dutch angle">Dynamic dutch angle</option>
                            <option value="over-the-shoulder">Over-the-shoulder</option>
                            <option value="fisheye lens">Fisheye lens</option>
                            <option value="tilt-shift">Tilt-shift</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="colors" class="block text-sm font-medium mb-1">Color Palette</label>
                        <select id="colors">
                            <option value="">Any colors</option>
                            <option value="monochromatic">Monochromatic</option>
                            <option value="analogous">Analogous</option>
                            <option value="complementary">Complementary</option>
                            <option value="triadic">Triadic</option>
                            <option value="pastel">Pastel</option>
                            <option value="vibrant saturated">Vibrant saturated</option>
                            <option value="dark and moody">Dark and moody</option>
                            <option value="earth tones">Earth tones</option>
                            <option value="neon cyberpunk">Neon cyberpunk</option>
                            <option value="black and white">Black and white</option>
                        </select>
                    </div>
                </div>
                
                <div class="lg:col-span-1">
                     <div class="section-header">
                        <h2 class="text-2xl font-semibold text-purple-400 flex items-center">
                            <i class="fas fa-sliders-h mr-2"></i> Advanced Settings
                        </h2>
                        <button class="randomize-section-btn" id="randomizeAdvancedBtn" title="Randomize Advanced Settings">
                            <i class="fas fa-dice-three"></i>
                        </button>
                    </div>
                    <div class="mb-4">
                        <label for="mood" class="block text-sm font-medium mb-1">Mood/Atmosphere</label>
                        <select id="mood">
                            <option value="">Any mood</option>
                            <option value="mysterious and ominous">Mysterious and ominous</option>
                            <option value="epic and grandiose">Epic and grandiose</option>
                            <option value="whimsical and playful">Whimsical and playful</option>
                            <option value="melancholic and nostalgic">Melancholic and nostalgic</option>
                            <option value="futuristic and technological">Futuristic and technological</option>
                            <option value="ethereal and dreamlike">Ethereal and dreamlike</option>
                            <option value="tense and dramatic">Tense and dramatic</option>
                            <option value="serene and peaceful">Serene and peaceful</option>
                            <option value="chaotic and energetic">Chaotic and energetic</option>
                            <option value="romantic and intimate">Romantic and intimate</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="textures" class="block text-sm font-medium mb-1">Texture & Materials</label>
                        <input type="text" id="textures" placeholder="e.g., brushed metal, cracked leather">
                    </div>
                    <div class="mb-4">
                        <label for="artists" class="block text-sm font-medium mb-1">Artistic References</label>
                        <select id="artists">
                            <option value="">No specific reference</option>
                            <optgroup label="Classic Artists">
                                <option value="inspired by Caravaggio">Caravaggio</option>
                                <option value="inspired by Van Gogh">Van Gogh</option>
                                <option value="inspired by Monet">Monet</option>
                                <option value="inspired by H.R. Giger">H.R. Giger</option>
                            </optgroup>
                            <optgroup label="Contemporary Artists">
                                <option value="inspired by Greg Rutkowski">Greg Rutkowski</option>
                                <option value="inspired by Artgerm">Artgerm</option>
                                <option value="inspired by Loish">Loish</option>
                                <option value="inspired by Simon StÃ¥lenhag">Simon StÃ¥lenhag</option>
                            </optgroup>
                            <optgroup label="Animation Styles">
                                <option value="Studio Ghibli style">Studio Ghibli</option>
                                <option value="Pixar animated style">Pixar</option>
                                <option value="Disney Renaissance style">Disney Renaissance</option>
                                <option value="Anime style">Anime</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-1">Technical Details</label>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <select id="resolution">
                                    <option value="">Resolution</option>
                                    <option value="4K">4K</option>
                                    <option value="8K">8K</option>
                                    <option value="16K">16K</option>
                                    <option value="ultra HD">Ultra HD</option>
                                </select>
                            </div>
                            <div>
                                <select id="render">
                                    <option value="">Render Engine</option>
                                    <option value="Octane render">Octane</option>
                                    <option value="Unreal Engine 5">UE5</option>
                                    <option value="Arnold render">Arnold</option>
                                    <option value="Redshift render">Redshift</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label for="negativePrompt" class="block text-sm font-medium mb-1">Negative Prompt</label>
                        <input type="text" id="negativePrompt" placeholder="e.g., blurry, text, watermark, ugly">
                    </div>
                    <div class="mb-4">
                        <label for="promptSuffix" class="block text-sm font-medium mb-1">Prompt Suffix/Emphasis</label>
                        <input type="text" id="promptSuffix" placeholder="e.g., --ar 16:9, (masterpiece:1.2)">
                    </div>
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center">
                            <input type="checkbox" id="videoPrompt" class="w-4 h-4 text-purple-600 rounded focus:ring-purple-500 border-gray-300">
                            <label for="videoPrompt" class="ml-2 text-sm">Generate for video (Sora)</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="highDetail" class="w-4 h-4 text-purple-600 rounded focus:ring-purple-500 border-gray-300" checked>
                            <label for="highDetail" class="ml-2 text-sm">Ultra Detail</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 flex flex-col sm:flex-row justify-center items-center gap-4">
                <button id="generateBtn" class="btn btn-primary group">
                    <i class="fas fa-magic mr-2 group-hover:rotate-12 transition-transform"></i> Generate Prompt
                </button>
                <button id="randomizeAllBtn" class="btn btn-secondary group">
                    <i class="fas fa-random mr-2 group-hover:rotate-180 transition-transform"></i> Randomize All
                </button>
            </div>

            <div class="mt-8 border-t pt-6" id="presetSection"> <h3 class="text-xl font-semibold mb-3 text-purple-400 text-center">Preset Management</h3>
                <div class="flex flex-col sm:flex-row justify-center items-center gap-4">
                    <input type="text" id="presetName" placeholder="Preset Name" class="sm:max-w-xs">
                    <button id="savePresetBtn" class="btn btn-secondary group">
                        <i class="fas fa-save mr-2 group-hover:animate-bounce-short"></i> Save Preset
                    </button>
                </div>
                <div class="mt-4 text-center">
                    <label for="loadPresetSelect" class="block text-sm font-medium mb-1">Load Preset:</label>
                    <select id="loadPresetSelect" class="max-w-xs mx-auto">
                        <option value="">-- Select a Preset --</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div id="results" class="hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-semibold text-purple-400">Generated Prompts</h2>
                <div class="flex items-center">
                    <span class="text-sm mr-2" id="darkModeLabel">Dark Mode</span> <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                        <input type="checkbox" name="toggle" id="darkModeToggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full border-4 appearance-none cursor-pointer"/>
                        <label for="darkModeToggle" class="toggle-label block overflow-hidden h-6 rounded-full cursor-pointer"></label>
                    </div>
                    <button id="copyAllBtn" class="text-purple-400 hover:text-purple-300 transition-colors flex items-center text-sm">
                        <i class="far fa-copy mr-1"></i> Copy All
                    </button>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div id="promptCard1" class="prompt-card rounded-xl p-6 fade-in">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-center">
                            <span class="bg-purple-900 text-purple-100 text-xs px-2 py-1 rounded mr-2">V1</span>
                            <h3 class="font-medium text-purple-300">Cinematic Style</h3>
                        </div>
                        <button class="copy-btn text-purple-400 hover:text-purple-200 transition-colors" data-target="prompt1-text">
                            <i class="far fa-copy"></i>
                        </button>
                    </div>
                    <p id="prompt1-text" class="text-sm min-h-[60px]"></p> <div class="mt-4 flex flex-wrap gap-2" id="tags1">
                        </div>
                </div>
                
                <div id="promptCard2" class="prompt-card rounded-xl p-6 fade-in">
                     <div class="flex justify-between items-start mb-4">
                        <div class="flex items-center">
                            <span class="bg-purple-900 text-purple-100 text-xs px-2 py-1 rounded mr-2">V2</span>
                            <h3 class="font-medium text-purple-300">Artistic Style</h3>
                        </div>
                        <button class="copy-btn text-purple-400 hover:text-purple-200 transition-colors" data-target="prompt2-text">
                            <i class="far fa-copy"></i>
                        </button>
                    </div>
                    <p id="prompt2-text" class="text-sm min-h-[60px]"></p> <div class="mt-4 flex flex-wrap gap-2" id="tags2"></div>
                </div>
                
                <div id="promptCard3" class="prompt-card rounded-xl p-6 fade-in">
                     <div class="flex justify-between items-start mb-4">
                        <div class="flex items-center">
                            <span class="bg-purple-900 text-purple-100 text-xs px-2 py-1 rounded mr-2">V3</span>
                            <h3 class="font-medium text-purple-300">Concept Art Style</h3>
                        </div>
                        <button class="copy-btn text-purple-400 hover:text-purple-200 transition-colors" data-target="prompt3-text">
                            <i class="far fa-copy"></i>
                        </button>
                    </div>
                    <p id="prompt3-text" class="text-sm min-h-[60px]"></p> <div class="mt-4 flex flex-wrap gap-2" id="tags3"></div>
                </div>
                
                <div id="promptCard4" class="prompt-card rounded-xl p-6 fade-in">
                    <div class="flex justify-between items-start mb-4">
                        <div class="flex items-center">
                            <span class="bg-purple-900 text-purple-100 text-xs px-2 py-1 rounded mr-2">V4</span>
                            <h3 class="font-medium text-purple-300">Photorealistic Style</h3>
                        </div>
                        <button class="copy-btn text-purple-400 hover:text-purple-200 transition-colors" data-target="prompt4-text">
                            <i class="far fa-copy"></i>
                        </button>
                    </div>
                    <p id="prompt4-text" class="text-sm min-h-[60px]"></p> <div class="mt-4 flex flex-wrap gap-2" id="tags4"></div>
                </div>
            </div>
            
            <div class="mt-8 flex flex-col sm:flex-row justify-center items-center gap-4">
                <button id="regenerateBtn" class="btn btn-primary group">
                    <i class="fas fa-sync-alt mr-2 group-hover:rotate-180 transition-transform"></i> Regenerate All
                </button>
                <button id="enhanceBtn" class="btn btn-secondary group">
                    <i class="fas fa-wand-magic-sparkles mr-2 group-hover:animate-pulse-fast"></i> Enhance Details
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- DOM Elements ---
            const generateBtn = document.getElementById('generateBtn');
            const regenerateBtn = document.getElementById('regenerateBtn');
            const randomizeAllBtn = document.getElementById('randomizeAllBtn');
            const randomizeCoreBtn = document.getElementById('randomizeCoreBtn');
            const randomizeStyleBtn = document.getElementById('randomizeStyleBtn');
            const randomizeAdvancedBtn = document.getElementById('randomizeAdvancedBtn');
            const enhanceBtn = document.getElementById('enhanceBtn');
            const savePresetBtn = document.getElementById('savePresetBtn');
            const loadPresetSelect = document.getElementById('loadPresetSelect');
            const presetNameInput = document.getElementById('presetName');
            const copyAllBtn = document.getElementById('copyAllBtn');
            const resultsSection = document.getElementById('results');
            const darkModeToggle = document.getElementById('darkModeToggle');
            const settingsContainer = document.getElementById('settingsContainer');
            const presetSection = document.getElementById('presetSection');
            const darkModeLabel = document.getElementById('darkModeLabel');

            // Input Fields (grouped for easier access in preset handling)
            const inputFields = {
                subject: document.getElementById('subject'),
                subjectDesc: document.getElementById('subject-desc'),
                environment: document.getElementById('environment'),
                action: document.getElementById('action'),
                style: document.getElementById('style'),
                customStyle: document.getElementById('customStyle'),
                lighting: document.getElementById('lighting'),
                composition: document.getElementById('composition'),
                colors: document.getElementById('colors'),
                mood: document.getElementById('mood'),
                textures: document.getElementById('textures'),
                artists: document.getElementById('artists'),
                resolution: document.getElementById('resolution'),
                render: document.getElementById('render'),
                negativePrompt: document.getElementById('negativePrompt'),
                promptSuffix: document.getElementById('promptSuffix'),
                videoPrompt: document.getElementById('videoPrompt'),
                highDetail: document.getElementById('highDetail'),
            };
            
            // --- Component Libraries (for randomization and generation) ---
            const sampleValues = {
                subjects: ["cyberpunk hacker", "mystical forest spirit", "steampunk airship captain", "post-apocalyptic scavenger", "renaissance alchemist", "futuristic neon samurai", "ancient golem guardian", "celestial cartographer", "dream weaver", "bio-luminescent jellyfish queen"],
                environments: ["neon-lit Tokyo alleyway", "ancient overgrown ruins", "floating sky city", "underground cybernetic lab", "Victorian-era library", "alien desert landscape", "crystal cave system", "submerged Atlantis", "clockwork dimension", "nebula garden"],
                actions: ["casting a powerful spell", "hacking into a mainframe", "steering through a storm", "negotiating with a rogue AI", "discovering an ancient artifact", "battling a shadow creature", "painting a cosmic mural", "leading an expedition", "meditating under twin moons", "building a time machine"],
                textures: ["weathered brass, cracked leather, frosted glass", "polished chrome, glowing circuits, liquid metal", "hand-carved wood, stained parchment, candle wax", "rusted iron, cracked concrete, neon reflections", "silk brocade, tarnished silver, obsidian shards", "bioluminescent fungi, iridescent scales, woven starlight"],
                customStyles: ["vintage sci-fi poster art", "gritty neo-noir comic book style", "ethereal watercolor dreamscape", "bold art deco illustration", "pixel art adventure game scene", "claymation diorama"],
                negativePrompts: ["blurry, low quality, text, watermark", "ugly, disfigured, extra limbs", "poorly drawn hands, mutated faces", "boring, flat, oversaturated"],
                promptSuffixes: ["--ar 16:9", "--ar 9:16", "--style raw", "--chaos 50", "(masterpiece:1.3), (best quality:1.2)", "--v 6.0"]
            };

            const descriptors = ["intricately detailed", "hyper-realistic", "exquisitely rendered", "masterfully composed", "visually striking", "breathtaking", "technically impressive", "professionally lit", "carefully framed", "ultra-high definition", "razor-sharp", "meticulously crafted", "stunningly beautiful", "award-winning", "museum quality"];
            const cameraTerms = ["shot on 85mm lens", "captured with cinematic lighting", "using shallow depth of field", "with dramatic chiaroscuro", "featuring dynamic composition", "with perfect symmetry", "using anamorphic lens flares", "with meticulous attention to detail", "shot on ARRI Alexa", "using Cooke anamorphic lenses", "with beautiful bokeh", "using natural lighting", "with studio-quality lighting", "shot on medium format", "with perfect exposure"];
            const artReferences = ["inspired by Studio Ghibli", "reminiscent of Moebius illustrations", "with a touch of Beksinski", "evoking ZdzisÅaw BeksiÅski's style", "in the manner of Greg Rutkowski", "inspired by Hayao Miyazaki", "with Artgerm's vibrant colors", "in the style of Alphonse Mucha", "reminiscent of Van Gogh's brushwork", "inspired by Caravaggio's lighting", "with Klimt's decorative elements", "in the style of H.R. Giger", "inspired by Simon StÃ¥lenhag", "with Loish's vibrant colors", "in the style of Norman Rockwell"];
            const videoTerms = ["smooth camera movement", "cinematic slow motion", "dynamic tracking shot", "steady glidecam footage", "professional drone cinematography", "fluid motion blur", "seamless transitions between scenes", "with parallax effects", "with beautiful camera choreography", "featuring cinematic camera angles", "with dynamic camera moves", "using Steadicam stabilization", "with dramatic dolly zooms", "featuring sweeping crane shots", "with immersive first-person perspective"];
            const textureKeywords = ["with intricate surface details", "featuring realistic material textures", "with visible brush strokes", "showing detailed fabric textures", "with realistic skin pores", "featuring detailed weathering", "with beautiful water reflections", "showing realistic metal patina", "with intricate carved details", "featuring realistic subsurface scattering", "with detailed wood grain", "showing realistic stone texture", "with beautiful glass refraction", "featuring realistic fur details", "with intricate embroidery patterns"];
            const postProcessing = ["professional color grading", "studio quality post-processing", "meticulous attention to detail", "perfectly balanced composition", "with subtle film grain", "featuring cinematic color grading", "with professional retouching", "using advanced compositing techniques", "with HDR enhancement", "featuring depth of field effects", "with professional sharpening", "using advanced denoising", "with beautiful glow effects", "featuring subtle vignetting", "with professional tone mapping"];
            
            // --- Dark Mode Logic ---
            function applyDarkMode(isDark) {
                if (isDark) {
                    document.documentElement.classList.add('dark');
                    settingsContainer.classList.remove('bg-gray-50', 'border-gray-200');
                    settingsContainer.classList.add('bg-dark-800', 'border-dark-700');
                    presetSection.classList.remove('border-gray-300');
                    presetSection.classList.add('border-dark-600');
                    darkModeLabel.textContent = 'Dark Mode';
                    document.querySelectorAll('.prompt-card p, label, h2, h3, .text-sm').forEach(el => {
                        if(!el.closest('.gradient-bg')) el.classList.add('text-dark-100');
                         el.classList.remove('text-gray-700', 'text-gray-800');
                    });
                } else {
                    document.documentElement.classList.remove('dark');
                    settingsContainer.classList.add('bg-gray-50', 'border-gray-200');
                    settingsContainer.classList.remove('bg-dark-800', 'border-dark-700');
                    presetSection.add('border-gray-300');
                    presetSection.remove('border-dark-600');
                    darkModeLabel.textContent = 'Light Mode';
                     document.querySelectorAll('.prompt-card p, label, h2, h3, .text-sm').forEach(el => {
                        if(!el.closest('.gradient-bg')) el.classList.remove('text-dark-100');
                        el.classList.add('text-gray-700'); // Or specific light mode text colors
                    });
                }
            }

            // Check localStorage for saved preference
            const savedDarkMode = localStorage.getItem('darkMode');
            if (savedDarkMode === 'enabled') {
                darkModeToggle.checked = true;
                applyDarkMode(true);
            } else if (savedDarkMode === 'disabled') {
                darkModeToggle.checked = false;
                applyDarkMode(false);
            } else { // Default to dark mode if no preference
                 darkModeToggle.checked = true;
                 applyDarkMode(true);
                 localStorage.setItem('darkMode', 'enabled');
            }

            darkModeToggle.addEventListener('change', function() {
                if (this.checked) {
                    applyDarkMode(true);
                    localStorage.setItem('darkMode', 'enabled');
                } else {
                    applyDarkMode(false);
                    localStorage.setItem('darkMode', 'disabled');
                }
            });

            // --- Event Listeners ---
            generateBtn.addEventListener('click', generatePrompts);
            regenerateBtn.addEventListener('click', generatePrompts);
            randomizeAllBtn.addEventListener('click', randomizeAllFields);
            randomizeCoreBtn.addEventListener('click', () => randomizeSection('core'));
            randomizeStyleBtn.addEventListener('click', () => randomizeSection('style'));
            randomizeAdvancedBtn.addEventListener('click', () => randomizeSection('advanced'));
            enhanceBtn.addEventListener('click', enhanceDetails);
            savePresetBtn.addEventListener('click', savePreset);
            loadPresetSelect.addEventListener('change', loadPreset);
            copyAllBtn.addEventListener('click', copyAllPrompts);
            
            // Copy button functionality for individual prompts
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const targetId = this.getAttribute('data-target');
                    const textToCopy = document.getElementById(targetId).textContent;
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        const icon = this.querySelector('i');
                        icon.classList.remove('fa-copy', 'far');
                        icon.classList.add('fa-check', 'fas');
                        setTimeout(() => {
                            icon.classList.remove('fa-check', 'fas');
                            icon.classList.add('fa-copy', 'far');
                        }, 2000);
                    }).catch(err => console.error("Failed to copy: ", err));
                });
            });

            // Custom style input clearing dropdown and vice-versa
            inputFields.customStyle.addEventListener('input', () => {
                if (inputFields.customStyle.value.trim() !== '') {
                    inputFields.style.value = '';
                }
            });
            inputFields.style.addEventListener('change', () => {
                if (inputFields.style.value !== '') {
                    inputFields.customStyle.value = '';
                }
            });
            
            // --- Core Functions ---
            function generatePrompts() {
                const currentValues = {};
                for (const key in inputFields) {
                    currentValues[key] = inputFields[key].type === 'checkbox' ? inputFields[key].checked : inputFields[key].value.trim();
                }

                if (!currentValues.subject) {
                    alert('Please enter a main subject for your prompt');
                    inputFields.subject.focus();
                    inputFields.subject.classList.add('border-red-500', 'ring-red-500');
                    setTimeout(() => inputFields.subject.classList.remove('border-red-500', 'ring-red-500'), 3000);
                    return;
                }
                
                resultsSection.classList.remove('hidden');
                
                const promptStyles = ["cinematic", "artistic", "concept art", "photorealistic"];
                promptStyles.forEach((pStyle, index) => {
                    const i = index + 1;
                    const promptText = createPrompt(currentValues, pStyle, i);
                    document.getElementById(`prompt${i}-text`).textContent = promptText;
                    
                    // Update tags dynamically
                    const tagsContainer = document.getElementById(`tags${i}`);
                    tagsContainer.innerHTML = ''; // Clear existing tags
                    const mainStyleTag = currentValues.customStyle || currentValues.style || pStyle;
                    if (mainStyleTag) addTag(tagsContainer, mainStyleTag);
                    if (currentValues.resolution) addTag(tagsContainer, currentValues.resolution);
                    if (currentValues.render) addTag(tagsContainer, currentValues.render.split(' ')[0]); // e.g. "Octane" from "Octane render"
                    if (currentValues.mood) addTag(tagsContainer, currentValues.mood.split(' ')[0]); // First word of mood
                    if (currentValues.isVideo) addTag(tagsContainer, "Video");


                    const card = document.getElementById(`promptCard${i}`);
                    card.classList.remove('fade-in');
                    void card.offsetWidth; 
                    card.classList.add('fade-in');
                });
                
                resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            function addTag(container, text) {
                const tag = document.createElement('span');
                tag.className = `text-xs px-2 py-1 rounded ${document.documentElement.classList.contains('dark') ? 'bg-dark-700 text-dark-200' : 'bg-gray-200 text-gray-700'}`;
                tag.textContent = text.charAt(0).toUpperCase() + text.slice(1); // Capitalize first letter
                container.appendChild(tag);
            }
            
            function createPrompt(values, promptStyleVariant, variantNum) {
                let prompt = "";
                
                prompt += `${values.subject}, `;
                if (values.subjectDesc) prompt += `${values.subjectDesc}, `;
                if (values.environment) prompt += `set in ${values.environment}, `;
                if (values.action) prompt += `${values.action}, `;
                
                // Determine primary style: custom > dropdown > variant default
                let chosenStyle = values.customStyle || values.style;

                switch(promptStyleVariant) {
                    case "cinematic":
                        if (!chosenStyle) prompt += "cinematic style, ";
                        prompt += "film still from a blockbuster movie, ";
                        if (!values.lighting) prompt += "dramatic studio lighting, ";
                        if (!values.composition) prompt += "medium close-up shot, ";
                        if (!values.colors) prompt += "complementary color scheme, ";
                        if (!values.mood) prompt += "epic and grandiose atmosphere, ";
                        break;
                    case "artistic":
                        if (!chosenStyle) prompt += "oil painting style, ";
                        prompt += "fine art piece, ";
                        if (!values.lighting) prompt += "Rembrandt lighting, ";
                        if (!values.composition) prompt += "carefully balanced composition, ";
                        if (!values.colors) prompt += "rich color palette, ";
                        if (!values.mood) prompt += "emotional and expressive, ";
                        break;
                    case "concept art":
                        if (!chosenStyle) prompt += "concept art style, ";
                        prompt += "production design artwork, ";
                        if (!values.lighting) prompt += "directional lighting, ";
                        if (!values.composition) prompt += "dynamic angle, ";
                        if (!values.colors) prompt += "limited color palette, ";
                        if (!values.mood) prompt += "futuristic and technological, ";
                        break;
                    case "photorealistic":
                        if (!chosenStyle) prompt += "hyperrealistic style, ";
                        prompt += "photograph, ";
                        if (!values.lighting) prompt += "natural lighting, ";
                        if (!values.composition) prompt += "perfectly framed, ";
                        if (!values.colors) prompt += "true-to-life colors, ";
                        if (!values.mood) prompt += "authentic and realistic, ";
                        break;
                }
                
                if (chosenStyle) prompt += `${chosenStyle}, `;
                if (values.lighting) prompt += `${values.lighting}, `;
                if (values.composition) prompt += `${values.composition}, `;
                if (values.colors) prompt += `${values.colors}, `;
                if (values.mood) prompt += `${values.mood}, `;
                
                prompt += `${getRandomElement(descriptors)}, `;
                prompt += `${getRandomElement(cameraTerms)}, `;
                
                if ((!chosenStyle || Math.random() > 0.3) && values.artists) {
                    prompt += `${values.artists}, `;
                } else if (!chosenStyle || Math.random() > 0.5) {
                    prompt += `${getRandomElement(artReferences)}, `;
                }
                
                if (values.textures) {
                    prompt += `${values.textures}, `;
                } else if (values.highDetail) {
                    prompt += `${getRandomElement(textureKeywords)}, `;
                }
                
                if (values.resolution) prompt += `${values.resolution}, `;
                if (values.render) prompt += `${values.render}, `;
                
                if (values.isVideo) {
                    prompt += `${getRandomElement(videoTerms)}, `;
                    prompt += `4K resolution, 24fps cinematic framerate, `;
                    const videoVariants = ["with subtle film grain", "dynamic depth of field", "choreographed movement", "subtle environmental interactions"];
                    prompt += `${videoVariants[variantNum - 1]}, `;
                }
                
                const variantElements = ["hyper-detailed textures", "intricate background elements", "thoughtful negative space", "layered visual depth"];
                prompt += `${variantElements[variantNum - 1]}, `;
                prompt += `${getRandomElement(postProcessing)}`;
                
                if (values.negativePrompt) {
                    prompt += ` --no ${values.negativePrompt}`;
                }
                if (values.promptSuffix) {
                    prompt += ` ${values.promptSuffix}`;
                }
                
                prompt = prompt.replace(/,\s*$/, '').replace(/,\s*--no/, ' --no').replace(/  +/g, ' ').trim();
                return prompt.charAt(0).toUpperCase() + prompt.slice(1);
            }

            function getRandomElement(arr) {
                return arr[Math.floor(Math.random() * arr.length)];
            }

            function randomizeAllFields() {
                randomizeSection('core', false);
                randomizeSection('style', false);
                randomizeSection('advanced', false); // Pass false to prevent immediate regeneration
                generatePrompts(); // Then generate once all are randomized
            }

            function randomizeSection(section, triggerGenerate = true) {
                let fieldsToRandomize = {};
                if (section === 'core') {
                    fieldsToRandomize = {
                        subject: inputFields.subject,
                        subjectDesc: inputFields.subjectDesc, // Can be empty or random snippet
                        environment: inputFields.environment,
                        action: inputFields.action
                    };
                    inputFields.subject.value = getRandomElement(sampleValues.subjects);
                    inputFields.subjectDesc.value = Math.random() > 0.5 ? getRandomElement(sampleValues.actions).substring(0,30) + "..." : ""; // Short random desc
                    inputFields.environment.value = getRandomElement(sampleValues.environments);
                    inputFields.action.value = getRandomElement(sampleValues.actions);
                } else if (section === 'style') {
                    fieldsToRandomize = {
                        style: inputFields.style,
                        customStyle: inputFields.customStyle, // Clear or add random custom
                        lighting: inputFields.lighting,
                        composition: inputFields.composition,
                        colors: inputFields.colors
                    };
                    // Prefer dropdown style for this randomization, clear custom
                    inputFields.customStyle.value = '';
                    randomizeSelect(inputFields.style);
                    randomizeSelect(inputFields.lighting);
                    randomizeSelect(inputFields.composition);
                    randomizeSelect(inputFields.colors);

                } else if (section === 'advanced') {
                    fieldsToRandomize = {
                        mood: inputFields.mood,
                        textures: inputFields.textures,
                        artists: inputFields.artists,
                        resolution: inputFields.resolution,
                        render: inputFields.render,
                        negativePrompt: inputFields.negativePrompt,
                        promptSuffix: inputFields.promptSuffix,
                        videoPrompt: inputFields.videoPrompt,
                        highDetail: inputFields.highDetail
                    };
                    randomizeSelect(inputFields.mood);
                    inputFields.textures.value = getRandomElement(sampleValues.textures);
                    randomizeSelect(inputFields.artists);
                    randomizeSelect(inputFields.resolution);
                    randomizeSelect(inputFields.render);
                    inputFields.negativePrompt.value = Math.random() > 0.6 ? getRandomElement(sampleValues.negativePrompts) : "";
                    inputFields.promptSuffix.value = Math.random() > 0.6 ? getRandomElement(sampleValues.promptSuffixes) : "";
                    inputFields.videoPrompt.checked = Math.random() > 0.7;
                    inputFields.highDetail.checked = Math.random() > 0.3;
                }

                if (triggerGenerate) {
                    generatePrompts();
                }
            }

            function randomizeSelect(selectElement) {
                 if (selectElement && selectElement.options.length > 1) {
                    const randomIndex = Math.floor(Math.random() * (selectElement.options.length -1)) + 1; // Avoid first "-- Select --" option
                    selectElement.selectedIndex = randomIndex;
                } else if (selectElement && selectElement.options.length === 1 && selectElement.options[0].value === "") {
                    // Only one option and it's the placeholder, do nothing or set to 0
                    selectElement.selectedIndex = 0;
                }
            }
            
            function enhanceDetails() {
                for (let i = 1; i <= 4; i++) {
                    const promptTextElem = document.getElementById(`prompt${i}-text`);
                    let currentPrompt = promptTextElem.textContent;
                    // Remove existing suffix and negative prompt for cleaner enhancement
                    currentPrompt = currentPrompt.replace(/ --no .*/, '').replace(/ --ar .*/, '').replace(/\([\w\s.:]+\d\)/, '');

                    const newTexture = getRandomElement(textureKeywords);
                    const newPostProcessing = getRandomElement(postProcessing);
                    
                    // Avoid adding duplicates if possible
                    let enhancedPrompt = currentPrompt;
                    if (!currentPrompt.includes(newTexture.split(' ')[0])) { // Check first word of texture
                        enhancedPrompt += `, ${newTexture}`;
                    }
                    if (!currentPrompt.includes(newPostProcessing.split(' ')[0])) { // Check first word of post-processing
                         enhancedPrompt += `, ${newPostProcessing}`;
                    }
                    
                    // Re-add original suffix and negative prompt if they existed in input fields
                    if (inputFields.negativePrompt.value) {
                        enhancedPrompt += ` --no ${inputFields.negativePrompt.value}`;
                    }
                    if (inputFields.promptSuffix.value) {
                        enhancedPrompt += ` ${inputFields.promptSuffix.value}`;
                    }

                    promptTextElem.textContent = enhancedPrompt.replace(/,\s*$/, '').trim();
                    
                    const card = document.getElementById(`promptCard${i}`);
                    card.classList.add('ring-2', 'ring-purple-500', 'animate-pulse-fast');
                    setTimeout(() => {
                        card.classList.remove('ring-2', 'ring-purple-500', 'animate-pulse-fast');
                    }, 1500);
                }
            }
            
            // --- Preset Management ---
            function savePreset() {
                const name = presetNameInput.value.trim();
                if (!name) {
                    alert('Please enter a name for the preset.');
                    presetNameInput.focus();
                    return;
                }

                const presetData = {};
                for (const key in inputFields) {
                    presetData[key] = inputFields[key].type === 'checkbox' ? inputFields[key].checked : inputFields[key].value;
                }

                localStorage.setItem(`promptCraftPreset_${name}`, JSON.stringify(presetData));
                alert(`Preset "${name}" saved!`);
                presetNameInput.value = ''; // Clear input
                populatePresetList(); // Refresh list
            }

            function loadPreset() {
                const name = loadPresetSelect.value;
                if (!name) return;

                const presetDataString = localStorage.getItem(`promptCraftPreset_${name}`);
                if (presetDataString) {
                    const presetData = JSON.parse(presetDataString);
                    for (const key in presetData) {
                        if (inputFields[key]) {
                            if (inputFields[key].type === 'checkbox') {
                                inputFields[key].checked = presetData[key];
                            } else {
                                inputFields[key].value = presetData[key];
                            }
                        }
                    }
                    alert(`Preset "${name}" loaded!`);
                    generatePrompts(); // Optionally generate prompts after loading
                }
            }

            function populatePresetList() {
                loadPresetSelect.innerHTML = '<option value="">-- Select a Preset --</option>'; // Clear existing
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    if (key.startsWith('promptCraftPreset_')) {
                        const presetName = key.replace('promptCraftPreset_', '');
                        const option = document.createElement('option');
                        option.value = presetName;
                        option.textContent = presetName;
                        loadPresetSelect.appendChild(option);
                    }
                }
            }
            
            function copyAllPrompts() {
                let allPromptsText = "";
                for (let i = 1; i <= 4; i++) {
                    allPromptsText += `Prompt Version ${i}:\n${document.getElementById(`prompt${i}-text`).textContent}\n\n`;
                }
                navigator.clipboard.writeText(allPromptsText.trim()).then(() => {
                    const icon = copyAllBtn.querySelector('i');
                    icon.classList.remove('fa-copy', 'far');
                    icon.classList.add('fa-check', 'fas');
                    setTimeout(() => {
                        icon.classList.remove('fa-check', 'fas');
                        icon.classList.add('fa-copy', 'far');
                    }, 2000);
                }).catch(err => console.error("Failed to copy all: ", err));
            }

            // Initial population
            populatePresetList();
            applyDarkMode(darkModeToggle.checked); // Apply initial dark mode based on toggle state (which is set by localStorage or default)

        });
    </script>
</body>
</html>
